:root{
  --bg:#0b141a; --top:#202c33; --brand:#111b21; --me:#005c4b; --friend:#202c33; --text:#e9edef; --muted:#8696a0;
  --blue:#34b7f1; --accent:#25d366; --bubble:#1f2c34; --kbd:#0f1c22; --shadow:rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text); background:#0e1316;
}
#app{display:flex; gap:16px; padding:16px; height:100vh; overflow:hidden}
.panel{
  width:380px; min-width:320px; background:#0f171b; border:1px solid #1c282f; border-radius:14px; padding:14px; overflow:auto
}
.panel h2{margin:10px 0 8px; font-size:16px}
.hint{color:var(--muted); font-size:12px; margin:4px 0 8px}
textarea#scriptInput{
  width:100%; height:260px; background:#0b1216; color:var(--text);
  border:1px solid #1c2930; border-radius:10px; padding:10px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px
}
.panel-actions{display:flex; gap:8px; margin:8px 0 16px}
.panel button{
  background:#14323b; border:1px solid #1e3c45; color:#d8f3ff; padding:8px 10px; border-radius:10px; cursor:pointer
}
.panel button:disabled{opacity:.5; cursor:not-allowed}
.settings{display:grid; gap:10px}
.settings label{display:grid; gap:6px; font-size:13px}
.settings input, .settings select{
  background:#0b1216; color:var(--text); border:1px solid #1c2930; padding:8px; border-radius:8px
}
.settings .row{display:flex; align-items:center; justify-content:space-between}
.help pre{
  background:#0b1216; border:1px solid #1c2930; padding:10px; border-radius:8px; overflow:auto
}

.phone{
  position:relative; flex:1; background:var(--bg);
  border:1px solid #1b2430; border-radius:18px; box-shadow:0 10px 40px var(--shadow);
  display:grid; $156px 1fr auto auto; overflow:hidden
}
.topbar{
  background:var(--top); display:flex; align-items:center; justify-content:space-between; padding:8px 12px; border-bottom:1px solid #1b2430
}
.topbar .left{display:flex; gap:10px; align-items:center}
.avatar{width:32px; height:32px; border-radius:50%; background:#2a3b45; display:grid; place-items:center; color:#bfefff; font-weight:700}
.name{font-weight:700}
.status{font-size:12px; color:var(--muted)}
.topbar .right .icon{margin-left:10px; opacity:.9}

.brand{height:28px; background:var(--brand); color:var(--muted); display:flex; align-items:center; padding:0 12px; font-size:12px; letter-spacing:.5px}

.chat{padding:12px; display:flex; flex-direction:column; gap:8px; overflow:auto; background:url('assets/bg.png') center/cover fixed no-repeat}
.bubble{
  max-width:70%; padding:8px 10px; border-radius:12px; position:relative; font-size:14px; line-height:1.35; word-wrap:break-word; white-space:pre-wrap
}
.bubble.me{background:var(--me); margin-left:auto; border-top-right-radius:4px}
.bubble.friend{background:var(--friend); margin-right:auto; border-top-left-radius:4px}
.meta{display:flex; gap:6px; align-items:center; font-size:11px; color:#cfe8f7; opacity:.9; margin-top:4px}
.ticks{font-size:12px; line-height:1}
.ticks.blue{color:#89d5ff}
.ticks.muted{color:#96a7b0}

.typing{
  padding:6px 10px; margin:0 12px 10px auto; width:68px; background:var(--bubble); border-radius:12px; display:flex; gap:6px; align-items:center
}
.typing.hidden{display:none}
.dot{
  width:6px; height:6px; border-radius:50%; background:#cfe8f7; opacity:.5; animation:b 1s infinite ease-in-out
}
.dot:nth-child(2){animation-delay:.2s}
.dot:nth-child(3){animation-delay:.4s}
@keyframes b{0%,80%,100%{transform:translateY(0)}40%{transform:translateY(-3px)}}

.controls{
  display:flex; gap:8px; padding:8px; background:#0e171c; border-top:1px solid #1b2430
}
.controls button{
  background:#12333b; border:1px solid #1e3c45; color:#d8f3ff; padding:8px 12px; border-radius:10px; cursor:pointer
}

.keyboard{
  background:var(--kbd); border-top:1px solid #1b2430; padding:8px 8px 14px; display:grid; gap:6px
}
.kb-row{display:flex; gap:6px; justify-content:center}
.key{
  min-width:28px; padding:8px 10px; background:#0b151a; border:1px solid #1c2930; border-radius:8px; text-align:center; font-size:13px; color:#cfe8f7; opacity:.85
}
.key.wide{min-width:64px}
.key.space{min-width:180px}
.key.active{background:#17343d; border-color:#2a5b66; transform:translateY(1px)}
.kb-screen{
  margin:0 auto 6px; width:96%; min-height:28px; background:#071015; border:1px solid #162229; border-radius:8px; padding:6px 8px; color:#e1f5ff; font-family:ui-monospace,Consolas,monospace; font-size:13px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap
}

/* scrollbar thin */
.chat::-webkit-scrollbar{width:7px}
.chat::-webkit-scrollbar-thumb{background:#1a2a31; border-radius:6px}
.topbar .right img.ic{width:22px;height:22px;vertical-align:middle;filter:invert(85%);opacity:.9}

/* layout fix: keyboard */
.keyboard{ align-content:center }
.kb-row{ justify-content:center }
/* ======= COMPACT TOPBAR + KEYBOARD (overrides) ======= */

/* Thinner top bar */
.topbar{
  height:44px; min-height:44px;
  padding:4px 8px;
}
.topbar .left{ gap:6px }
.avatar{ width:26px; height:26px; font-size:13px }
.name{ font-size:14px; line-height:1 }
.status{ font-size:11px }
.topbar .right .icon{ margin-left:8px }
.topbar .right img.ic{ width:18px; height:18px; opacity:.9 }

/* Adjust phone grid: header 44px, chat 1fr, typing auto, keyboard auto */
.phone{ grid-template-rows:44px 1fr auto auto }

/* Compact keyboard: no gaps, edge-to-edge, consistent row fill */
.keyboard{
  padding:4px 4px 6px;
  background:#0f1c22;
}
.kb-row{
  display:flex;
  gap:0;                 /* no spaces between keys */
  justify-content:stretch;
}
.key{
  flex:1 1 0;            /* expand to fill row evenly */
  min-width:0;
  padding:6px 6px;       /* tighter */
  border-radius:6px;
  margin:0;              /* eliminate gaps */
  text-align:center;
  font-size:12px;
  line-height:1.1;
}
.key.wide{ flex:1.6 1 0 }   /* ⇧, ⌫ slightly wider */
.key.space{ flex:6 1 0 }    /* space bar much wider */

/* Make the small display tighter too */
.kb-screen{
  width:100%;
  margin:0 0 4px 0;
  min-height:22px;
  padding:4px 6px;
  font-size:12px;
}

/* Optional: nudge rows vertically tighter inside keyboard */
.keyboard .kb-row + .kb-row{ margin-top:4px }
/* ==== Simple Script Editor (blocks separated by 3 blank lines) ==== */
.script-controls { display:grid; gap:8px; margin:8px 0 }
.script-controls select {
  background:#0b1216; color:#e9edef; border:1px solid #1c2930; padding:6px 8px; border-radius:8px; font-size:13px
}
.script-editor-hint { margin:6px 0 8px }
.script-editor{
  width:100%; min-height:280px; background:#0b1216; color:#e9edef;
  border:1px solid #1c2930; border-radius:10px; padding:10px;
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:13px;
  white-space:pre-wrap; word-wrap:break-word; outline:none; overflow:auto;
}
.script-editor .block{ margin:0; padding:0 }
.script-editor .block.me{ color:#93f9b9 }      /* green-ish for Me */
.script-editor .block.friend{ color:#ffe066 }  /* yellow-ish for Friend */
/* lighter caret visibility on dark background */
.script-editor:focus{ box-shadow:0 0 0 1px #244 inset }

/* tighten rows in keyboard if needed */
.keyboard .kb-row + .kb-row{ margin-top:4px }
